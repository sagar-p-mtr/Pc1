#include <stdio.h> 
#include <stdlib.h> 
#include <omp.h> 
#include <time.h> 
#define MAX 10 

void merge(int arr[], int l, int m, int r) { 
    int i = l, j = m + 1, k = l, *temp = (int *)malloc(sizeof(int) * (r + 1)); 
    
    while (i <= m && j <= r) {
        temp[k++] = (arr[i] <= arr[j]) ? arr[i++] : arr[j++];
    }
    while (i <= m) {
        temp[k++] = arr[i++]; 
    }
    while (j <= r) {
        temp[k++] = arr[j++]; 
    }
    for (i = l; i <= r; i++) {
        arr[i] = temp[i]; 
    }
    free(temp);
} 

void sequentialMergeSort(int arr[], int l, int r) { 
    if (l < r) { 
        int m = (l + r) / 2; 
        sequentialMergeSort(arr, l, m); 
        sequentialMergeSort(arr, m + 1, r); 
        merge(arr, l, m, r); 
    } 
} 

void parallel_Mergesort(int arr[], int l, int r) { 
    if (l < r) { 
        int m = (l + r) / 2; 
        #pragma omp parallel sections 
        { 
            #pragma omp section 
            parallel_Mergesort(arr, l, m); 
            #pragma omp section 
            parallel_Mergesort(arr, m + 1, r); 
        } 
        merge(arr, l, m, r); 
    } 
} 

int main() { 
    int n; 
    printf("Enter number of elements: "); 
    scanf("%d", &n); 
    
    int *arr = (int *)malloc(n * sizeof(int)); 
    int *arr_copy = (int *)malloc(n * sizeof(int)); 
    double start, end; 
    
    srand(time(NULL)); 
    printf("The original array is...\n"); 
    for (int i = 0; i < n; i++) { 
        arr[i] = rand() % MAX; 
        printf("%d ", arr[i]); 
        arr_copy[i] = arr[i]; 
    } 
    
    start = omp_get_wtime(); 
    sequentialMergeSort(arr, 0, n - 1); 
    end = omp_get_wtime(); 
    printf("\nSequential MergeSort Time: %f seconds\n", end - start); 
    printf("\nSorted Array using Sequential Processing is...\n"); 
    for (int i = 0; i < n; i++) printf("%d ", arr[i]); 
    
    start = omp_get_wtime(); 
    parallel_Mergesort(arr_copy, 0, n - 1); 
    end = omp_get_wtime(); 
    printf("\nParallel MergeSort Time: %f seconds\n", end - start); 
    printf("\nSorted Array using Parallel using Threads Processing is...\n"); 
    for (int i = 0; i < n; i++) printf("%d ", arr_copy[i]); 
    
    printf("\n");
    free(arr); 
    free(arr_copy); 
    return 0; 
}


gcc -fopenmp p1.c

./a.out
